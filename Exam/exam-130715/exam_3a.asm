		.MODEL SMALL
		.STACK 100h
		.DATA
	DELTA DQ ?
	X0 DQ ?
	X DQ ?
	FX DQ ? 
	FX0 DQ ?
	XIH DQ ?
	MIN DQ ?
	CUR_DELTA DQ ?
		.CODE
		.386
		.387
	_find_delta1 PROC NEAR
		PUBLIC _find_delta1
		PUSH BP
		MOV BP,SP
		FLD QWORD PTR [BP+6]
		FST X0 
		FABS 
		FSTP DELTA 
START_LOOP:
		FLD DELTA 
		FLD1
		FLD1
		FADD 
		FDIV
		FSTP DELTA 
		FLD X0 
		FADD DELTA 
		FSTP X 
CHECK_LOOP:
		SUB SP,8 
		FLD X 
		FSTP QWORD PTR [BP-8] 
		CALL WORD PTR [BP+4]
		ADD SP,8
		FSTP FX
		SUB SP,8
		FLD X0
		FSTP QWORD PTR [BP-8] 
		CALL WORD PTR [BP+4]
		ADD SP,8
		FSTP FX0 
		FLD FX 
		FSUB FX0 
		FABS 
		FCOMP QWORD PTR [BP+14]
		FSTSW AX
		SAHF 
		JAE START_LOOP
		
		FLD DELTA 
		POP BP
		RET 
	_find_delta1 ENDP
		
		
	_find_delta2 PROC NEAR 
		PUBLIC _find_delta2
		PUSH BP 
		MOV BP,SP
		FLD QWORD PTR [BP+6] 
		FST XIH
		FABS 
		FSTP MIN 
		JMP CHECK_LOOP1
START_LOOP1:
		SUB SP,16
		FLD QWORD PTR [BP+30]
		FSTP QWORD PTR [BP-8]
		FLD XIH
		FSTP QWORD PTR [BP-16]
		PUSH WORD PTR [BP+4]
		CALL _find_delta1
		ADD SP,18
		FST CUR_DELTA 
		FCOMP MIN 
		FSTSW AX 
		SAHF 
		JNB CUR_A
		FLD CUR_DELTA
		FSTP MIN 
CUR_A:
		FLD XIH 
		FADD QWORD PTR [BP+22]
		FSTP XIH 
CHECK_LOOP1:
		FLD XIH 
		FCOMP QWORD PTR [BP+14]
		FSTSW AX 
		SAHF 
		JB START_LOOP1
		
		FLD MIN 
		POP BP 
		RET 
	_find_delta2 ENDP 
		END
		